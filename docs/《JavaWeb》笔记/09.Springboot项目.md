---
title: Springbooté¡¹ç›®
decription: null
date: 2023-4-10
tags: 
  - åç«¯
categories: 
  - ã€ŠJavaWebã€‹ç¬”è®°
permalink: /pages/45cbc0199/
author: 
  name: cynicism
  link: https://github.com/cynicism-lab
---
## 1. æ¦‚è¿°
### 1.1 å‰åç«¯é¡¹ç›®æ„é€ 
![](https://cdn.jsdelivr.net/gh/Cynicism-lab/MyResource@gh-pages/image/image-20221213230710821.7iwkwoqbyx34.webp)
### 1.2 Springbootå·¥ç¨‹ç›®å½•ç»“æ„
![](https://cdn.jsdelivr.net/gh/Cynicism-lab/MyResource@gh-pages/image/image-20221213222039985.7f7y6w5p6dj4.webp)
![](https://cdn.jsdelivr.net/gh/Cynicism-lab/MyResource@gh-pages/image/image-20221213224927868.6ueqjcpz1vuo.webp)
### 1.3 å¼€å‘è§„èŒƒâ€”â€”REST
**â‘  åŸºäºRESTé£æ ¼URLå¦‚ä¸‹ï¼š**

```
http://localhost:8080/users/1  GETï¼šæŸ¥è¯¢idä¸º1çš„ç”¨æˆ·
http://localhost:8080/users    POSTï¼šæ–°å¢ç”¨æˆ·
http://localhost:8080/users    PUTï¼šä¿®æ”¹ç”¨æˆ·
http://localhost:8080/users/1  DELETEï¼šåˆ é™¤idä¸º1çš„ç”¨æˆ·
```

å…¶ä¸­æ€»ç»“èµ·æ¥ï¼Œå°±ä¸€å¥è¯ï¼šé€šè¿‡URLå®šä½è¦æ“ä½œçš„èµ„æºï¼Œé€šè¿‡HTTPåŠ¨è¯(è¯·æ±‚æ–¹å¼)æ¥æè¿°å…·ä½“çš„æ“ä½œã€‚  
**â‘¡ å¼€å‘è§„èŒƒ-ç»Ÿä¸€å“åº”ç»“æœ**  
å‰åç«¯å·¥ç¨‹åœ¨è¿›è¡Œäº¤äº’æ—¶ï¼Œä½¿ç”¨ç»Ÿä¸€å“åº”ç»“æœ Resultã€‚
~~~java
@Data
@NoArgsConstructor
@AllArgsConstructor
public class Result {
    private Integer code;//å“åº”ç ï¼Œ1 ä»£è¡¨æˆåŠŸ; 0 ä»£è¡¨å¤±è´¥
    private String msg;  //å“åº”ä¿¡æ¯ æè¿°å­—ç¬¦ä¸²
    private Object data; //è¿”å›çš„æ•°æ®

    //å¢åˆ æ”¹ æˆåŠŸå“åº”
    public static Result success(){
        return new Result(1,"success",null);
    }
    //æŸ¥è¯¢ æˆåŠŸå“åº”
    public static Result success(Object data){
        return new Result(1,"success",data);
    }
    //å¤±è´¥å“åº”
    public static Result error(String msg){
        return new Result(0,msg,null);
    }
}
~~~
## 2. åŠŸèƒ½å¼€å‘
### 2.1 åŸºç¡€åŠŸèƒ½â€”â€”å¢åˆ æ”¹æŸ¥
ğŸ’¡æ³¨è§£`@Slf4j` : åœ¨ç±»ä¸Šæ·»åŠ è¯¥æ³¨è§£ä¼šè‡ªåŠ¨ç”ŸæˆLoggerå¯¹è±¡ï¼Œå¯¹è±¡å **log**

> é—®é¢˜1ï¼šå¦‚ä½•é™å®šè¯·æ±‚æ–¹å¼ï¼Ÿï¼ˆæ§åˆ¶å±‚ï¼‰
> 
> @PostMapping â€”â€” å¢åŠ è¯·æ±‚
> 
> @DeleteMapping â€”â€” åˆ é™¤è¯·æ±‚
> 
> @GetMapping â€”â€” æŸ¥è¯¢è¯·æ±‚
> 
> @PutMapping â€”â€” ä¿®æ”¹è¯·æ±‚

> é—®é¢˜2ï¼šæ€ä¹ˆåœ¨controllerä¸­æ¥æ”¶jsonæ ¼å¼çš„è¯·æ±‚å‚æ•°ï¼Ÿ
> 
> **@RequestBody**  //æŠŠå‰ç«¯ä¼ é€’çš„jsonæ•°æ®å¡«å……åˆ°å®ä½“ç±»ä¸­

> é—®é¢˜3ï¼šæ€ä¹ˆåœ¨controllerä¸­æ¥æ”¶è·¯å¾„ä¸­çš„è¯·æ±‚å‚æ•°ï¼ˆå•ä¸ªï¼‰ï¼Ÿ
> 
> **@PathVariable**  //æŠŠè¯·æ±‚è·¯å¾„ï¼š/depts/**{id}**ä¸­çš„è·¯å¾„å‚æ•° {id}ä½œä¸ºè¯·æ±‚å‚æ•°
~~~java
@Slf4j
@RestController
public class DeptController {
    @Autowired
    private DeptService deptService;

    @PostMapping("/depts")
    public Result add(@RequestBody Dept dept){
        //è®°å½•æ—¥å¿—
        log.info("æ–°å¢éƒ¨é—¨ï¼š{}",dept);
        //è°ƒç”¨serviceå±‚æ·»åŠ åŠŸèƒ½
        deptService.add(dept);
        //å“åº”
        return Result.success();
    }

    //çœç•¥...
}
~~~

ğŸ’¡åœ¨Springå½“ä¸­ä¸ºäº†ç®€åŒ–è¯·æ±‚è·¯å¾„çš„å®šä¹‰ï¼Œå¯ä»¥æŠŠå…¬å…±çš„è¯·æ±‚è·¯å¾„ï¼Œç›´æ¥æŠ½å–åˆ°ç±»ä¸Šï¼Œåœ¨ç±»ä¸ŠåŠ ä¸€ä¸ªæ³¨è§£`@RequestMapping`ï¼Œå¹¶æŒ‡å®šè¯·æ±‚è·¯å¾„`"/depts"`
### 2.2 åˆ†é¡µæŸ¥è¯¢â€”â€”PageHelper
![](https://cdn.jsdelivr.net/gh/Cynicism-lab/MyResource@gh-pages/image/image-20221215152021068.2pjjdojr9abk.webp)
> åç«¯ç»™å‰ç«¯è¿”å›çš„æ•°æ®ï¼Œæˆ‘ä»¬é€šå¸¸å°è£…åˆ°PageBeanå¯¹è±¡(è‡ªå®šä¹‰**pojoç±»**)ä¸­ï¼Œå¹¶å°†è¯¥å¯¹è±¡è½¬æ¢ä¸ºjsonæ ¼å¼çš„æ•°æ®å“åº”å›ç»™æµè§ˆå™¨ã€‚

1ã€åœ¨pom.xmlå¼•å…¥ä¾èµ–
```xml
<dependency>
    <groupId>com.github.pagehelper</groupId>
    <artifactId>pagehelper-spring-boot-starter</artifactId>
    <version>1.4.2</version>
</dependency>
```
2ã€EmpMapper
```java
@Mapper
public interface EmpMapper {
    //è·å–å½“å‰é¡µçš„ç»“æœåˆ—è¡¨
    @Select("select * from emp")
    public List<Emp> page(Integer start, Integer pageSize);
}
```
3ã€EmpServiceImpl
```java
@Override
public PageBean page(Integer page, Integer pageSize) {
    // è®¾ç½®åˆ†é¡µå‚æ•°
    PageHelper.startPage(page, pageSize); 
    // æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢
    List<Emp> empList = empMapper.list(name,gender,begin,end); 
    // è·å–åˆ†é¡µç»“æœ
    Page<Emp> p = (Page<Emp>) empList;   
    //å°è£…PageBean
    PageBean pageBean = new PageBean(p.getTotal(), p.getResult()); 
    return pageBean;
}
```
> åœ¨æ‰§è¡ŒempMapper.list()æ–¹æ³•æ—¶ï¼Œå°±æ˜¯æ‰§è¡Œï¼šselect  *  from  emp   è¯­å¥ï¼Œæ€ä¹ˆèƒ½å¤Ÿå®ç°åˆ†é¡µæ“ä½œå‘¢ï¼Ÿ
>
> åˆ†é¡µæ’ä»¶å¸®æˆ‘ä»¬å®Œæˆäº†ä»¥ä¸‹æ“ä½œï¼š
>
> 1. å…ˆè·å–åˆ°è¦æ‰§è¡Œçš„SQLè¯­å¥ï¼šselect  *  from  emp      
> 2. æŠŠSQLè¯­å¥ä¸­çš„å­—æ®µåˆ—è¡¨ï¼Œå˜ä¸ºï¼šcount(*)
> 3. æ‰§è¡ŒSQLè¯­å¥ï¼šselect  count(*)  from  emp          //è·å–åˆ°æ€»è®°å½•æ•°
> 4. å†å¯¹è¦æ‰§è¡Œçš„SQLè¯­å¥ï¼šselect  *  from  emp è¿›è¡Œæ”¹é€ ï¼Œåœ¨æœ«å°¾æ·»åŠ  limit ? , ?
> 5. æ‰§è¡Œæ”¹é€ åçš„SQLè¯­å¥ï¼šselect  *  from  emp  limit  ? , ? 
### 2.3 æ–‡ä»¶ä¸Šä¼  â€”â€” æœ¬åœ°å­˜å‚¨
>æ–‡ä»¶ä¸Šä¼ ï¼Œæ˜¯æŒ‡å°†æœ¬åœ°å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œä¾›å…¶ä»–ç”¨æˆ·æµè§ˆæˆ–ä¸‹è½½çš„è¿‡ç¨‹ã€‚
#### 2.3.1 å‰ç«¯å®ç°ï¼š
- è¡¨å•æäº¤æ–¹å¼å¿…é¡»ä¸º`POST`
  > é€šå¸¸ä¸Šä¼ çš„æ–‡ä»¶ä¼šæ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ POST æäº¤æ–¹å¼
- è¡¨å•çš„ç¼–ç ç±»å‹**enctype**å¿…é¡»è¦è®¾ç½®ä¸ºï¼š**multipart/form-data**
  > æ™®é€šé»˜è®¤çš„ç¼–ç æ ¼å¼æ˜¯ä¸é€‚åˆä¼ è¾“å¤§å‹çš„äºŒè¿›åˆ¶æ•°æ®çš„ï¼Œæ‰€ä»¥åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œè¡¨å•çš„ç¼–ç æ ¼å¼å¿…é¡»è®¾ç½®ä¸ºmultipart/form-data
#### 2.3.2 åç«¯å®ç°:
- é¦–å…ˆåœ¨æœåŠ¡ç«¯å®šä¹‰è¿™ä¹ˆä¸€ä¸ªcontrollerï¼Œç”¨æ¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œç„¶ååœ¨controllerå½“ä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ¥å¤„ç†`/upload` ä¸Šä¼ æ–‡ä»¶è¯·æ±‚
- åœ¨å®šä¹‰çš„æ–¹æ³•ä¸­æ¥æ”¶æäº¤è¿‡æ¥çš„æ•°æ® ï¼ˆæ–¹æ³•ä¸­çš„å½¢å‚åå’Œè¯·æ±‚å‚æ•°çš„åå­—ä¿æŒä¸€è‡´ï¼‰
#### 2.3.3 æœ¬åœ°å­˜å‚¨
ä½¿ç”¨MultipartFileç±»æä¾›çš„APIæ–¹æ³•ï¼ŒæŠŠä¸´æ—¶æ–‡ä»¶è½¬å­˜åˆ°æœ¬åœ°ç£ç›˜ç›®å½•ä¸‹

> MultipartFile å¸¸è§æ–¹æ³•ï¼š 
> - String  getOriginalFilename();  //è·å–åŸå§‹æ–‡ä»¶å
> - void  transferTo(File dest);     //å°†æ¥æ”¶çš„æ–‡ä»¶è½¬å­˜åˆ°ç£ç›˜æ–‡ä»¶ä¸­
> - long  getSize();     //è·å–æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ï¼šå­—èŠ‚
> - byte[]  getBytes();    //è·å–æ–‡ä»¶å†…å®¹çš„å­—èŠ‚æ•°ç»„
> - InputStream  getInputStream();    //è·å–æ¥æ”¶åˆ°çš„æ–‡ä»¶å†…å®¹çš„è¾“å…¥æµ
~~~java
@Slf4j
@RestController
public class UploadController {
    @PostMapping("/upload")
    public Result upload(String username, Integer age, MultipartFile image) throws IOException {
        log.info("æ–‡ä»¶ä¸Šä¼ ï¼š{},{},{}",username,age,image);
        //è·å–åŸå§‹æ–‡ä»¶å
        String originalFilename = image.getOriginalFilename();
        //æ„å»ºæ–°çš„æ–‡ä»¶å
        String extname = originalFilename.substring(originalFilename.lastIndexOf("."));//æ–‡ä»¶æ‰©å±•å
        String newFileName = UUID.randomUUID().toString()+extname;//éšæœºå+æ–‡ä»¶æ‰©å±•å
        //å°†æ–‡ä»¶å­˜å‚¨åœ¨æœåŠ¡å™¨çš„ç£ç›˜ç›®å½•
        image.transferTo(new File("E:/images/"+newFileName));
        return Result.success();
    }
}
~~~
ğŸ’¡ä½¿ç”¨UUIDä¿è¯æ–‡ä»¶åå”¯ä¸€ï¼Œä¸ä¼šè¦†ç›–  
ğŸ’¡åœ¨SpringBootä¸­ï¼Œæ–‡ä»¶ä¸Šä¼ æ—¶é»˜è®¤å•ä¸ªæ–‡ä»¶æœ€å¤§å¤§å°ä¸º1M,å¦‚æœéœ€è¦ä¸Šä¼ å¤§æ–‡ä»¶ï¼Œå¯ä»¥åœ¨application.propertiesè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š
```java
#é…ç½®å•ä¸ªæ–‡ä»¶æœ€å¤§ä¸Šä¼ å¤§å°
spring.servlet.multipart.max-file-size=10MB
#é…ç½®å•ä¸ªè¯·æ±‚æœ€å¤§ä¸Šä¼ å¤§å°(ä¸€æ¬¡è¯·æ±‚å¯ä»¥ä¸Šä¼ å¤šä¸ªæ–‡ä»¶)
spring.servlet.multipart.max-request-size=100MB
```

## 3. é…ç½®æ–‡ä»¶
>å°†å„ä¸ªæ–‡ä»¶ä¸­çš„é…ç½®ä¿¡æ¯ç»Ÿä¸€å†™åœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œä¾¿äºç®¡ç†ç»´æŠ¤
### 3.1 propertiesé…ç½®æ–‡ä»¶
&emsp;application.propertiesæ˜¯springbooté¡¹ç›®é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥springbootç¨‹åºåœ¨å¯åŠ¨æ—¶ä¼šé»˜è®¤è¯»å–application.propertiesé…ç½®æ–‡ä»¶
~~~properties
aliyun.oss.endpoint=https://oss-cn-hangzhou.aliyuncs.com
aliyun.oss.accessKeyId=LTAI4GCH1vX6DKqJWxd6nEuW
aliyun.oss.accessKeySecret=yBshYweHOpqDuhCArrVHwIiBKpyqSL
aliyun.oss.bucketName=web-tlias
~~~

### 3.2 ymlé…ç½®æ–‡ä»¶ï¼ˆæƒ¯ç”¨ï¼‰
#### 3.2.1 ä¹¦å†™å½¢å¼
```properties
  aliyun:
  oss:
    endpoint: https://oss-cn-hangzhou.aliyuncs.com
    accessKeyId: LTAI4GCH1vX6DKqJWxd6nEuW
    accessKeySecret: yBshYweHOpqDuhCArrVHwIiBKpyqSL
    bucketName: web-397
```
#### 3.2.2 åŸºæœ¬è¯­æ³•
- å¤§å°å†™æ•æ„Ÿ
- æ•°å€¼å‰è¾¹å¿…é¡»æœ‰ç©ºæ ¼ï¼Œä½œä¸ºåˆ†éš”ç¬¦
- ä½¿ç”¨ç¼©è¿›è¡¨ç¤º**å±‚çº§**å…³ç³»ï¼Œç¼©è¿›æ—¶ï¼Œä¸å…è®¸ä½¿ç”¨Tabé”®ï¼Œåªèƒ½ç”¨ç©ºæ ¼ï¼ˆideaä¸­ä¼šè‡ªåŠ¨å°†Tabè½¬æ¢ä¸ºç©ºæ ¼ï¼‰
- ç¼©è¿›çš„ç©ºæ ¼æ•°ç›®ä¸é‡è¦ï¼Œåªè¦ç›¸åŒå±‚çº§çš„å…ƒç´ å·¦ä¾§å¯¹é½å³å¯
- `#`è¡¨ç¤ºæ³¨é‡Šï¼Œä»è¿™ä¸ªå­—ç¬¦ä¸€ç›´åˆ°è¡Œå°¾ï¼Œéƒ½ä¼šè¢«è§£æå™¨å¿½ç•¥

#### 3.2.3 å¸¸è§æ•°æ®æ ¼å¼
â‘   å®šä¹‰å¯¹è±¡æˆ–Mapé›†åˆ
```yml
user:
  name: zhangsan
  age: 18
  password: 123456
```
â‘¡ å®šä¹‰æ•°ç»„ã€listæˆ–seté›†åˆ
```yml
hobby: 
  - java
  - game
  - sport
```
### 3.3 é…ç½®å±æ€§æ³¨å…¥
#### 3.3.1 valueæ³¨è§£
é€šè¿‡ä½¿ç”¨ä¸€ä¸ªç°æˆçš„æ³¨è§£ï¼š`@Value`ï¼Œè·å–é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚

>@Value æ³¨è§£é€šå¸¸ç”¨äºå¤–éƒ¨é…ç½®çš„å±æ€§æ³¨å…¥

>å…·ä½“ç”¨æ³•ä¸ºï¼š @Value("${é…ç½®æ–‡ä»¶ä¸­çš„key}")
~~~java
@Component
public class AliOSSUtils {
    @Value("${aliyun.oss.endpoint}")
    private String endpoint;
 }   
~~~
>å½“éœ€è¦æ³¨å…¥çš„å±æ€§è¿‡å¤šæ—¶ï¼Œå°±ä¼šéå¸¸ç¹ç
#### 3.3.2 ConfigurationPropertiesæ³¨è§£
â‘  éœ€è¦åˆ›å»ºä¸€ä¸ªå®ç°ç±»ï¼Œä¸”å®ä½“ç±»ä¸­çš„å±æ€§åå’Œé…ç½®æ–‡ä»¶å½“ä¸­keyçš„åå­—å¿…é¡»è¦ä¸€è‡´

   > æ¯”å¦‚ï¼šé…ç½®æ–‡ä»¶å½“ä¸­å«endpointsï¼Œå®ä½“ç±»å½“ä¸­çš„å±æ€§ä¹Ÿå¾—å«endpointsï¼Œå¦å¤–å®ä½“ç±»å½“ä¸­çš„å±æ€§è¿˜éœ€è¦æä¾› getter / setteræ–¹æ³•

â‘¡ éœ€è¦å°†å®ä½“ç±»äº¤ç»™Springçš„IOCå®¹å™¨ç®¡ç†ï¼Œæˆä¸ºIOCå®¹å™¨å½“ä¸­çš„beanå¯¹è±¡

â‘¢ åœ¨å®ä½“ç±»ä¸Šæ·»åŠ `@ConfigurationProperties`æ³¨è§£ï¼Œå¹¶é€šè¿‡`perfect`å±æ€§æ¥æŒ‡å®šé…ç½®å‚æ•°é¡¹çš„å‰ç¼€
![](https://cdn.jsdelivr.net/gh/Cynicism-lab/MyResource@gh-pages/image/image-20230103210827003.2x90cttzn3cw.webp)

