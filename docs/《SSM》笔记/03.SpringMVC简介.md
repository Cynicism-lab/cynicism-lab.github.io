---
title: SpringMVCç®€ä»‹
date: 2023-04-20 
permalink: /pages/b7ec27/
categories: 
  - ã€ŠSSMã€‹ç¬”è®°
tags: 
  - springMVC
author: 
  name: cynicism
  link: https://github.com/cynicism-lab
---
## 1. æ¦‚è¿°
:::note å®šä¹‰
SpringMVCæ˜¯éš¶å±äºSpringæ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦æ˜¯ç”¨æ¥è¿›è¡ŒWebå¼€å‘ï¼Œæ˜¯å¯¹Servletè¿›è¡Œäº†å°è£…;å…¶ä¸»è¦çš„ä½œç”¨å°±æ˜¯ç”¨æ¥æ¥æ”¶å‰ç«¯å‘è¿‡æ¥çš„è¯·æ±‚å’Œæ•°æ®ç„¶åç»è¿‡å¤„ç†å¹¶å°†å¤„ç†çš„ç»“æœå“åº”ç»™å‰ç«¯
:::
å­¦ä¹ SpringMVCæˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸‹ç°åœ¨webç¨‹åºæ˜¯å¦‚ä½•åšçš„ï¼Œå’±ä»¬ç°åœ¨webç¨‹åºå¤§éƒ½åŸºäºä¸‰å±‚æ¶æ„æ¥å®ç°ã€‚


>æµè§ˆå™¨å‘é€ä¸€ä¸ªè¯·æ±‚ç»™åç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨ç°åœ¨æ˜¯ä½¿ç”¨Servletæ¥æ¥æ”¶è¯·æ±‚å’Œæ•°æ®, ä½†å¦‚æœæ‰€æœ‰çš„å¤„ç†éƒ½äº¤ç»™Servletæ¥å¤„ç†çš„è¯ï¼Œæ‰€æœ‰çš„ä¸œè¥¿éƒ½è€¦åˆåœ¨ä¸€èµ·ï¼Œå¯¹åæœŸçš„ç»´æŠ¤å’Œæ‰©å±•æä¸ºä¸åˆ©

* å°†åç«¯æœåŠ¡å™¨Servletæ‹†åˆ†æˆä¸‰å±‚ï¼Œåˆ†åˆ«æ˜¯`web`ã€`service`å’Œ`dao`
  * webå±‚ä¸»è¦ç”±servletæ¥å¤„ç†ï¼Œè´Ÿè´£é¡µé¢è¯·æ±‚å’Œæ•°æ®çš„æ”¶é›†ä»¥åŠå“åº”ç»“æœç»™å‰ç«¯
  * serviceå±‚ä¸»è¦è´Ÿè´£ä¸šåŠ¡é€»è¾‘çš„å¤„ç†
  * daoå±‚ä¸»è¦è´Ÿè´£æ•°æ®çš„å¢åˆ æ”¹æŸ¥æ“ä½œ
>ğŸ’¡**PS:** servletå¤„ç†è¯·æ±‚å’Œæ•°æ®çš„æ—¶å€™ï¼Œ<mark>å­˜åœ¨çš„é—®é¢˜æ˜¯ä¸€ä¸ªservletåªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚</mark>
* **é’ˆå¯¹webå±‚è¿›è¡Œäº†ä¼˜åŒ–ï¼Œé‡‡ç”¨äº†MVCè®¾è®¡æ¨¡å¼**ï¼Œå°†å…¶è®¾è®¡ä¸º`controller`ã€`view`å’Œ`Model`
  * controllerè´Ÿè´£è¯·æ±‚å’Œæ•°æ®çš„æ¥æ”¶ï¼Œæ¥æ”¶åå°†å…¶è½¬å‘ç»™serviceè¿›è¡Œä¸šåŠ¡å¤„ç†
  * serviceæ ¹æ®éœ€è¦ä¼šè°ƒç”¨daoå¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹æŸ¥
  * daoæŠŠæ•°æ®å¤„ç†å®Œåå°†ç»“æœäº¤ç»™service,serviceå†äº¤ç»™controller
  * controlleræ ¹æ®éœ€æ±‚ç»„è£…æˆModelå’ŒView,Modelå’ŒViewç»„åˆèµ·æ¥ç”Ÿæˆé¡µé¢è½¬å‘ç»™å‰ç«¯æµè§ˆå™¨
  * è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯controllerå¯ä»¥å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œå¹¶å¯¹è¯·æ±‚è¿›è¡Œåˆ†å‘ï¼Œæ‰§è¡Œä¸åŒçš„ä¸šåŠ¡æ“ä½œã€‚

>éšç€äº’è”ç½‘çš„å‘å±•ï¼Œä¸Šé¢çš„æ¨¡å¼å› ä¸ºæ˜¯**åŒæ­¥è°ƒç”¨**ï¼Œæ€§èƒ½æ…¢æ…¢çš„è·Ÿä¸æ˜¯éœ€æ±‚ï¼Œæ‰€ä»¥**å¼‚æ­¥è°ƒç”¨**æ…¢æ…¢çš„èµ°åˆ°äº†å‰å°ï¼Œæ˜¯ç°åœ¨æ¯”è¾ƒæµè¡Œçš„ä¸€ç§å¤„ç†æ–¹å¼ã€‚

![](https://cdn.staticaly.com/gh/Cynicism-lab/MyResource@gh-pages/image/1630427769938.2kjjnsvijef4.png)
* å› ä¸ºæ˜¯å¼‚æ­¥è°ƒç”¨ï¼Œæ‰€ä»¥åç«¯**ä¸éœ€è¦è¿”å›viewè§†å›¾**ï¼Œå°†å…¶å»é™¤
* å‰ç«¯å¦‚æœé€šè¿‡å¼‚æ­¥è°ƒç”¨çš„æ–¹å¼è¿›è¡Œäº¤äº’ï¼Œåå°å°±éœ€è¦å°†è¿”å›çš„æ•°æ®è½¬æ¢æˆjsonæ ¼å¼è¿›è¡Œè¿”å›
* SpringMVCä¸»è¦è´Ÿè´£çš„å°±æ˜¯
  * controllerå¦‚ä½•æ¥æ”¶è¯·æ±‚å’Œæ•°æ®
  * å¦‚ä½•å°†è¯·æ±‚å’Œæ•°æ®è½¬å‘ç»™ä¸šåŠ¡å±‚
  * å¦‚ä½•å°†å“åº”æ•°æ®è½¬æ¢æˆjsonå‘å›åˆ°å‰ç«¯

## 2. å·¥ä½œæµç¨‹
### 2.1 å¯åŠ¨æœåŠ¡å™¨åˆå§‹åŒ–è¿‡ç¨‹
![](https://cdn.staticaly.com/gh/Cynicism-lab/MyResource@gh-pages/image/1630432494752.x1gmekzj83k.webp)

1. æœåŠ¡å™¨å¯åŠ¨ï¼Œæ‰§è¡Œç»§æ‰¿AbstractDispatcherServletInitializerç±»çš„è‡ªå®šä¹‰ç±»ServletConfigï¼Œåˆå§‹åŒ–webå®¹å™¨
   * åŠŸèƒ½ç±»ä¼¼äºä»¥å‰çš„web.xml
>**AbstractDispatcherServletInitializer**ç±»æ˜¯SpringMVCæä¾›çš„å¿«é€Ÿåˆå§‹åŒ–Web3.0å®¹å™¨çš„æŠ½è±¡ç±»
```java
public class ServletConfig extends AbstractAnnotationConfigDispatcherServletInitializer {
    //åŠ è½½Springé…ç½®ç±»
    protected Class<?>[] getRootConfigClasses() {
        return new Class[]{SpringConfig.class};
    }
    //åŠ è½½SpringMVCé…ç½®ç±»
    protected Class<?>[] getServletConfigClasses() {
        return new Class[]{SpringMvcConfig.class};
    }
    //è®¾ç½®SpringMVCè¯·æ±‚åœ°å€æ‹¦æˆªè§„åˆ™
    protected String[] getServletMappings() {
        return new String[]{"/"};
    }
    //è®¾ç½®postè¯·æ±‚ä¸­æ–‡ä¹±ç è¿‡æ»¤å™¨
    @Override
    protected Filter[] getServletFilters() {
        CharacterEncodingFilter filter = new CharacterEncodingFilter();
        filter.setEncoding("utf-8");
        return new Filter[]{filter};
    }
}

```
2. æ‰§è¡ŒcreateServletApplicationContextæ–¹æ³•ï¼Œåˆ›å»ºWebApplicationContextå¯¹è±¡
   * è¯¥æ–¹æ³•åŠ è½½SpringMVCçš„é…ç½®ç±»SpringMvcConfigæ¥åˆå§‹åŒ–SpringMVCçš„å®¹å™¨
3. åŠ è½½SpringMvcConfigé…ç½®ç±»
![](https://cdn.staticaly.com/gh/Cynicism-lab/MyResource@gh-pages/image/1630433335744.lw0v359n04w.webp)

4. æ‰§è¡Œ`@ComponentScan`åŠ è½½å¯¹åº”çš„bean
   * æ‰«ææŒ‡å®šåŒ…åŠå…¶å­åŒ…ä¸‹æ‰€æœ‰ç±»ä¸Šçš„æ³¨è§£ï¼Œå¦‚Controllerç±»ä¸Šçš„@Controlleræ³¨è§£

5. åŠ è½½UserControllerï¼Œæ¯ä¸ª@RequestMappingçš„åç§°å¯¹åº”ä¸€ä¸ªå…·ä½“çš„æ–¹æ³•
![](https://cdn.staticaly.com/gh/Cynicism-lab/MyResource@gh-pages/image/1630433398932.384i3m2mgg74.webp)
   * æ­¤æ—¶å°±å»ºç«‹äº† `/save` å’Œ saveæ–¹æ³•çš„å¯¹åº”å…³ç³»

6. æ‰§è¡ŒgetServletMappingsæ–¹æ³•ï¼Œè®¾å®šSpringMVCæ‹¦æˆªè¯·æ±‚çš„è·¯å¾„è§„åˆ™
   ![](https://cdn.staticaly.com/gh/Cynicism-lab/MyResource@gh-pages/image/1630433510528.53nz0vz8o41s.webp)
   * `/`ä»£è¡¨æ‰€æ‹¦æˆªè¯·æ±‚çš„è·¯å¾„è§„åˆ™ï¼Œåªæœ‰è¢«æ‹¦æˆªåæ‰èƒ½äº¤ç»™SpringMVCæ¥å¤„ç†è¯·æ±‚

### 2.2 å•æ¬¡è¯·æ±‚è¿‡ç¨‹
1. å‘é€è¯·æ±‚`http://localhost/save`
2. webå®¹å™¨å‘ç°è¯¥è¯·æ±‚æ»¡è¶³SpringMVCæ‹¦æˆªè§„åˆ™ï¼Œå°†è¯·æ±‚äº¤ç»™SpringMVCå¤„ç†
3. è§£æè¯·æ±‚è·¯å¾„ /save
4. ç”±/saveåŒ¹é…æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•save(ï¼‰
   * ä¸Šé¢çš„ç¬¬äº”æ­¥å·²ç»å°†è¯·æ±‚è·¯å¾„å’Œæ–¹æ³•å»ºç«‹äº†å¯¹åº”å…³ç³»ï¼Œé€šè¿‡/saveå°±èƒ½æ‰¾åˆ°å¯¹åº”çš„saveæ–¹æ³•
5. æ‰§è¡Œsave()
6. æ£€æµ‹åˆ°æœ‰@ResponseBodyç›´æ¥å°†save()æ–¹æ³•çš„è¿”å›å€¼ä½œä¸ºå“åº”ä½“è¿”å›ç»™è¯·æ±‚æ–¹

## 3. beanåŠ è½½æ§åˆ¶
* configç›®å½•å­˜å…¥çš„æ˜¯é…ç½®ç±»,å†™è¿‡çš„é…ç½®ç±»æœ‰:
  * ServletContainersInitConfig
  * SpringConfig
  * SpringMvcConfig
  * JdbcConfig
  * MybatisConfig
* controllerç›®å½•å­˜æ”¾çš„æ˜¯SpringMVCçš„controllerç±»
* serviceç›®å½•å­˜æ”¾çš„æ˜¯serviceæ¥å£å’Œå®ç°ç±»
* daoç›®å½•å­˜æ”¾çš„æ˜¯dao/Mapperæ¥å£

>controllerã€serviceå’Œdaoè¿™äº›ç±»éƒ½éœ€è¦è¢«å®¹å™¨ç®¡ç†æˆbeanå¯¹è±¡ï¼Œé‚£ä¹ˆåˆ°åº•æ˜¯è¯¥è®©SpringMVCåŠ è½½è¿˜æ˜¯è®©SpringåŠ è½½å‘¢?

* SpringMVCåŠ è½½å…¶ç›¸å…³bean(è¡¨ç°å±‚bean),ä¹Ÿå°±æ˜¯controlleråŒ…ä¸‹çš„ç±»
* Springæ§åˆ¶çš„bean
  * ä¸šåŠ¡bean(Service)
  * åŠŸèƒ½bean(DataSource,SqlSessionFactoryBeanMapperScannerConfigurerç­‰)

>é€šè¿‡åœ¨é…ç½®ç±»ä¸­ä½¿ç”¨æ³¨è§£`@ComponentScan`ï¼Œæ¥è®¾ç½®ä¸åŒé…ç½®æ–‡ä»¶æ‰«æç®¡ç†beançš„èŒƒå›´

**ä¹Ÿå¯ä»¥é€šè¿‡excludeFiltersæ’é™¤ä¸€äº›æ— éœ€æ‰«æçš„ç±»ï¼š**
ä¾‹å¦‚ï¼šä¿®æ”¹Springé…ç½®ç±»ï¼Œè®¾å®šæ‰«æèŒƒå›´ä¸ºcom.itheima,æ’é™¤æ‰controlleråŒ…ä¸­çš„bean
```java
@Configuration
@ComponentScan(value="com.itheima",
    excludeFilters=@ComponentScan.Filter(
    	type = FilterType.ANNOTATION,
        classes = Controller.class
    )
)
public class SpringConfig {
}
```
* excludeFilterså±æ€§ï¼šè®¾ç½®æ‰«æåŠ è½½beanæ—¶ï¼Œæ’é™¤çš„è¿‡æ»¤è§„åˆ™
* typeå±æ€§ï¼šè®¾ç½®æ’é™¤è§„åˆ™ï¼Œå½“å‰ä½¿ç”¨æŒ‰ç…§beanå®šä¹‰æ—¶çš„æ³¨è§£ç±»å‹è¿›è¡Œæ’é™¤
* ANNOTATIONï¼šæŒ‰ç…§æ³¨è§£æ’é™¤








