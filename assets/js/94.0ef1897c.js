(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{458:function(t,s,a){"use strict";a.r(s);var n=a(8),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("blockquote",[s("p",[s("strong",[t._v("性能监控 -----》性能分析------》性能调优")])])]),t._v(" "),s("h2",{attrs:{id:"_1-性能监控-发现问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-性能监控-发现问题"}},[t._v("#")]),t._v(" 1. 性能监控(发现问题)")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("具体问题")]),t._v(" "),s("th",[t._v("监控工具")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("GC频繁")]),t._v(" "),s("td",[t._v("jstat")])]),t._v(" "),s("tr",[s("td",[t._v("CPU占用过高")]),t._v(" "),s("td",[t._v("jstat")])]),t._v(" "),s("tr",[s("td",[t._v("OOM")]),t._v(" "),s("td",[t._v("jmap")])]),t._v(" "),s("tr",[s("td",[t._v("内存泄露")]),t._v(" "),s("td",[t._v("jmap")])]),t._v(" "),s("tr",[s("td",[t._v("死锁（线程）")]),t._v(" "),s("td",[t._v("jstack")])]),t._v(" "),s("tr",[s("td",[t._v("程序响应时间过长（线程）")]),t._v(" "),s("td",[t._v("jstack")])])])]),t._v(" "),s("h2",{attrs:{id:"_2-命令行指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-命令行指令"}},[t._v("#")]),t._v(" 2. 命令行指令")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("jps")]),t._v("：查看正在运行的java进程")]),t._v(" "),s("li",[s("strong",[t._v("jstat")]),t._v("：可以"),s("strong",[t._v("持续监视")]),t._v("虚拟机各种运行状态信息，包括类加载、"),s("strong",[t._v("内存")]),t._v("、"),s("strong",[t._v("垃圾收集")]),t._v("等运行时数据")]),t._v(" "),s("li",[s("strong",[t._v("jmap")]),t._v("：导出"),s("strong",[t._v("当前时刻")]),t._v("的内存映像文件（dump二进制文件）和内存使用情况")]),t._v(" "),s("li",[s("strong",[t._v("jstack")]),t._v("：生成"),s("strong",[t._v("当前时刻")]),t._v("的线程快照（线程正在执行的方法堆栈集合以及执行状态）")])]),t._v(" "),s("blockquote",[s("p",[t._v("可视化工具：Visual VM")])]),t._v(" "),s("h2",{attrs:{id:"_3-评价指标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-评价指标"}},[t._v("#")]),t._v(" 3. 评价指标")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("停顿时间")])]),t._v(" "),s("ul",[s("li",[t._v("应用程序中指的是提交请求和返回请求的响应之间使用的时间；")]),t._v(" "),s("li",[t._v("GC中指的是暂停工作线程的时间")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("吞吐量")])]),t._v(" "),s("ul",[s("li",[t._v("单位时间内完成的工作量")]),t._v(" "),s("li",[t._v("GC中指的是运行用户代码的时间占总运行时间的比例")])])])]),t._v(" "),s("h2",{attrs:{id:"_4-内存泄漏"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-内存泄漏"}},[t._v("#")]),t._v(" 4. 内存泄漏")]),t._v(" "),s("div",{staticClass:"custom-block note"},[s("p",{staticClass:"custom-block-title"},[t._v("定义")]),t._v(" "),s("p",[t._v("内存中"),s("strong",[t._v("一直存在")]),t._v("，但是"),s("strong",[t._v("不再被使用")]),t._v("的"),s("strong",[t._v("对象")])])]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("静态集合类")])])]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Test")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// list即为静态集合类")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" list "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("oomTest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" str "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("blockquote",[s("p",[t._v("长生命周期的对象（"),s("strong",[t._v("静态集合类")]),t._v("）持有短生命周期的对象（例子中的"),s("strong",[t._v("局部对象")]),t._v("）的引用，导致短生命周期的对象无法被回收")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("strong",[t._v("单例模式")])])]),t._v(" "),s("blockquote",[s("p",[t._v("与静态集合类的原因相似，如果单例对象持有外部对象的引用，导致外部对象也无法回收")])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("strong",[t._v("连接未关闭")])])]),t._v(" "),s("blockquote",[s("p",[t._v("各种连接，如数据库连接、网络连接、文件流等，如果没有关闭，就会造成内存泄漏")])]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[s("strong",[t._v("变量不合理的作用域")])])]),t._v(" "),s("blockquote",[s("p",[t._v("变量定义的作用范围大于其使用范围，例如该变量只在某个方法内被使用，导致变量无法被回收（与对象的生命周期相同），造成内存泄漏")])]),t._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[s("strong",[t._v("缓存泄露")])])]),t._v(" "),s("blockquote",[s("p",[t._v("把对象引用放入缓存中，容易被遗忘，尽管进行了GC，这些对象无法被回收，导致内存泄漏，"),s("mark",[t._v("解决方案：使用WeakHashMap代表缓存")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);