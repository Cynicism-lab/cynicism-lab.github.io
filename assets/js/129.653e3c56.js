(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{489:function(t,s,a){"use strict";a.r(s);var n=a(8),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("æç¤º")]),t._v(" "),s("p",[t._v("æœ¬æ–‡ä¸»è¦è®°å½•springMVCçš„webå®¹å™¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•åŠ è½½åˆå§‹åŒ–Springçš„IOCå®¹å™¨")])]),t._v(" "),s("h2",{attrs:{id:"_1-springmvcé…ç½®æ–¹å¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-springmvcé…ç½®æ–¹å¼"}},[t._v("#")]),t._v(" 1. SpringMVCé…ç½®æ–¹å¼")]),t._v(" "),s("h3",{attrs:{id:"_1-1-web-inf"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-web-inf"}},[t._v("#")]),t._v(" 1.1 WEB-INF")]),t._v(" "),s("p",[t._v("åœ¨webå®¹å™¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨"),s("strong",[t._v("WEB-INFæ–‡ä»¶å¤¹")]),t._v("ä¸‹å¯»æ‰¾åä¸º[servlet-name]-servlet.xmlçš„é…ç½®æ–‡ä»¶ä½œä¸ºSpringMVCçš„é…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹springMVCçš„é…ç½®æ–‡ä»¶å°±æ˜¯æ”¾åœ¨WEB-INFä¸‹åä¸ºdispatcherServlet-servlet.xmlçš„é…ç½®æ–‡ä»¶")]),t._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dispatcherServlet"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet-class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.web.servlet.DispatcherServlet"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet-class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("load-on-startup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("load-on-startup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet-mapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dispatcherServlet"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url-pattern")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url-pattern")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet-mapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("h3",{attrs:{id:"_1-2-ç±»è·¯å¾„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-ç±»è·¯å¾„"}},[t._v("#")]),t._v(" 1.2 ç±»è·¯å¾„")]),t._v(" "),s("p",[t._v("ç›´æ¥åœ¨ç±»è·¯å¾„ï¼ˆ"),s("strong",[t._v("Resourceæ–‡ä»¶å¤¹")]),t._v("ï¼‰ä¸‹é…ç½®SpringMVCé…ç½®æ–‡ä»¶")]),t._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("DispatcherServlet"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet-class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.web.servlet.DispatcherServlet"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet-class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("init-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("contextConfigLocation"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("classpath:springmvcconfig.xml"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("init-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("load-on-startup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("load-on-startup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet-mapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("servlet-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("DispatcherServlet"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url-pattern")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url-pattern")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("servlet-mapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("åœ¨web.xmlä¸‹å¯ä»¥çœ‹åˆ° "),s("strong",[t._v("DispatcherServlet")]),t._v(" æ˜¯SpringMVCçš„æ ¸å¿ƒï¼Œä¸‹é¢å°†é‡ç‚¹è®²è§£DispatcherServletçš„åŸç†ä»¥åŠä½œç”¨ã€‚")]),t._v(" "),s("h2",{attrs:{id:"_2-springiocå®¹å™¨å’Œwebå®¹å™¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-springiocå®¹å™¨å’Œwebå®¹å™¨"}},[t._v("#")]),t._v(" 2. SpringIOCå®¹å™¨å’ŒWebå®¹å™¨")]),t._v(" "),s("p",[s("mark",[t._v("SpringIOCæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œå®ƒå¹¶ä¸æ˜¯ç›´æ¥åœ¨Webå®¹å™¨ä¸­å‘æŒ¥ä½œç”¨çš„")])]),t._v(" "),s("p",[t._v("å¦‚æœè¦åœ¨Webå®¹å™¨ä¸­ä½¿ç”¨IOCå®¹å™¨ï¼Œéœ€è¦Springä¸ºIOCè®¾è®¡ä¸€ä¸ªå¯åŠ¨è¿‡ç¨‹ï¼ŒæŠŠIOCå®¹å™¨å¯¼å…¥ï¼Œå¹¶å°†Webå®¹å™¨ä¸­å»ºç«‹èµ·æ¥ã€‚")]),t._v(" "),s("p",[t._v("å…·ä½“æ¥è¯´ï¼ŒSpringIOCå®¹å™¨çš„å¯åŠ¨è¿‡ç¨‹æ˜¯å’ŒWebå®¹å™¨çš„å¯åŠ¨è¿‡ç¨‹é›†æˆåœ¨ä¸€èµ·çš„ã€‚åœ¨è¿™ä¸ªå¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œ"),s("strong",[t._v("ä¸€æ–¹é¢å¤„ç†Webå®¹å™¨çš„å¯åŠ¨ï¼Œå¦ä¸€æ–¹é¢å¤„ç†SpringIOCå®¹å™¨çš„å¯åŠ¨è¿‡ç¨‹")]),t._v("ï¼Œå¯¹äºSpringIOCå®¹å™¨çš„å¯åŠ¨è¿‡ç¨‹éœ€è¦è®¾è®¡ç‰¹å®šçš„"),s("strong",[t._v("Webå®¹å™¨æ‹¦æˆªå™¨: ContextLoaderListener")]),t._v("ï¼Œå°†SpringIOCå®¹å™¨é›†æˆåˆ°Webå®¹å™¨ä¸­ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ã€‚")]),t._v(" "),s("p",[t._v("å®Œæˆäº†ä¸Šè¿°è¿‡ç¨‹ï¼ŒSpringIOCå®¹å™¨æ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œè€ŒSpringMVCæ˜¯å»ºç«‹åœ¨IOCå®¹å™¨çš„åŸºç¡€ä¸Šçš„ï¼Œè¿™æ ·æ‰èƒ½å»ºç«‹èµ·MVCæ¡†æ¶çš„è¿è¡Œæœºåˆ¶ï¼Œä»è€Œå“åº”ä»å®¹å™¨ä¼ é€’çš„HTTPè¯·æ±‚ã€‚")]),t._v(" "),s("h2",{attrs:{id:"_3-contextloaderlistener"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-contextloaderlistener"}},[t._v("#")]),t._v(" 3. ContextLoaderListener")]),t._v(" "),s("p",[t._v("è¿™æ˜¯ä¸€ä¸ªå®é™…é¡¹ç›®åœºæ™¯çš„springmvcçš„é…ç½®æ–‡ä»¶web.xml\n"),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Cynicism-lab/MyResource/img/img_06da42e16f9568866cad9fbcb78a5b52.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("contextConfigLocation å¯¹åº”çš„valueæ˜¯Springé…ç½®æ–‡ä»¶çš„ç»å¯¹è·¯å¾„\nç›‘å¬å™¨ä¸»è¦ç”¨æ¥å¯¹Servletå®¹å™¨(è¿™é‡ŒæŒ‡Tomcat)çš„è¡Œä¸ºè¿›è¡Œç›‘å¬ï¼Œè¿™é‡Œä¸»è¦å…³æ³¨"),s("strong",[t._v("ContextLoaderListener")])])]),t._v(" "),s("div",{staticClass:"custom-block note"},[s("p",{staticClass:"custom-block-title"},[t._v("ç¬”è®°")]),t._v(" "),s("p",[t._v("ContextLoaderListener ç»§æ‰¿è‡ª ContextLoader,å¹¶ä¸”è¿˜å®ç°äº† ServletContextListener å¹¶ä¸”å®ƒçš„æ„é€ å‡½æ•°ä¸­ä¼ å…¥äº†ä¸€ä¸ªWebApplicationContext,å®ƒæ˜¯ç»§æ‰¿è‡ªApplicationContextæ¥å£çš„é«˜çº§IoCå®¹å™¨")])]),t._v(" "),s("p",[t._v("ğŸ”ServletContextListener æ˜¯ Servlet ä¸­æ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªæ¥å£:"),s("strong",[t._v("ç›‘å¬ Servlet å®¹å™¨çš„å¯åŠ¨å’Œé”€æ¯äº‹ä»¶")])]),t._v(" "),s("p",[t._v("æ‰€ä»¥åœ¨ ContextLoaderListener ä¸­ï¼š")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("contextInitializedæ–¹æ³•")]),t._v(" ï¼šå‚æ•°ä¸ºæ‰€è¦ç›‘å¬çš„ServletContextEventï¼Œä¹Ÿå°±æ˜¯"),s("strong",[t._v("Tomcatå¯åŠ¨åŠ è½½å®Œweb.xmlä¼šäº§ç”Ÿçš„äº‹ä»¶")]),t._v("ï¼ŒServletContextEvent æŒæœ‰ä»web.xmlåŠ è½½çš„åˆå§‹åŒ–é…ç½®çš„ ServletContext ä¸Šä¸‹æ–‡")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("contextDestroyedæ–¹æ³•")]),t._v(" ï¼šåœ¨"),s("strong",[t._v("Tomcatå…³é—­")]),t._v("çš„æ—¶å€™æ‰§è¡Œè¯¥æ–¹æ³•ï¼Œå¯åŠ¨æ—¶ï¼ŒServletContextListener çš„æ‰§è¡Œé¡ºåºä¸web.xmlä¸­çš„é…ç½®é¡ºåºä¸€è‡´ï¼Œåœæ­¢æ—¶æ‰§è¡Œé¡ºåºæ­£ç›¸å")])])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("æ¢³ç†æµç¨‹")]),t._v("\nå½“Servletå®¹å™¨å¯åŠ¨äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå°†è¢«ContextLoaderLister ç›‘å¬ã€‚æ­¤æ—¶ ContextLoaderListener ä¼šè°ƒç”¨å®ç° ServletContextListener æ¥å£åå®ç°çš„ "),s("strong",[t._v("contextInitialized")]),t._v(" æ–¹æ³•ï¼Œå¹¶æŠŠåœ¨web.xmlåŠ è½½åˆå§‹åŒ–åè·å–çš„ ServletContext ä¼ å…¥"),s("strong",[t._v("initWebApplicationContext")]),t._v("æ–¹æ³•ä¸­è¿›è¡ŒIoCå®¹å™¨çš„åˆå§‹åŒ–")])]),t._v(" "),s("h2",{attrs:{id:"_4-spring-iocå®¹å™¨åˆå§‹åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-spring-iocå®¹å™¨åˆå§‹åŒ–"}},[t._v("#")]),t._v(" 4. Spring IOCå®¹å™¨åˆå§‹åŒ–")]),t._v(" "),s("blockquote",[s("p",[t._v("ä¸»è¦æ˜¯é€šè¿‡ "),s("strong",[t._v("initWebApplicationContext")]),t._v("æ–¹æ³•å¯¹IOCå®¹å™¨è¿›è¡Œåˆå§‹åŒ–")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Cynicism-lab/MyResource/img/spring-14.jpg",alt:""}})]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationContext")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initWebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletContext")]),t._v(" servletContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ¤æ–­åœ¨webå®¹å™¨ä¸­æ˜¯å¦å­˜åœ¨WebApplicationContextï¼Œå› ä¸ºåœ¨é…ç½®ä¸­åªå…è®¸ç”³æ˜ä¸€æ¬¡ServletContextListenerï¼Œå¤šæ¬¡å£°æ˜ä¼šæ‰°ä¹±Springçš„æ‰§è¡Œé€»è¾‘ã€‚")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("servletContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAttribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æŠ›å‡ºå¼‚å¸¸")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. åˆ›å»ºWebApplicationContext")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("servletContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç¡®ä¿è¯¥å®¹å™¨æ˜¯å¯é…ç½®çš„webå®¹å™¨")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConfigurableWebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConfigurableWebApplicationContext")]),t._v(" cwac "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConfigurableWebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("cwac"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isActive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸Šä¸‹æ–‡å°šæœªåˆ·æ–° - >æä¾›è¯¸å¦‚è®¾ç½®çˆ¶ä¸Šä¸‹æ–‡ï¼Œè®¾ç½®åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡IDç­‰æœåŠ¡")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cwac"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getParent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åœ¨Webå®¹å™¨ä¸­å»ºç«‹èµ·åŒäº²IOCå®¹å™¨")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ApplicationContext")]),t._v(" parent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadParentContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("servletContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\tcwac"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setParent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. ç»è¿‡ä¸Šé¢ä¸¤ä¸ªæ­¥éª¤ï¼Œç°åœ¨å¼€å§‹é…ç½®å¹¶åˆå§‹åŒ–WebApplicationContextã€‚")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("configureAndRefreshWebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cwac"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" servletContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3. å°†å·²ç»å®Œæˆåˆå§‹åŒ–çš„XmlWebApplicationContextå®¹å™¨æ³¨å†Œåˆ°servletContextä¸­å»")]),t._v("\n\tservletContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAttribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br")])]),s("ol",[s("li",[t._v("è°ƒç”¨ContextLoaderListenerä¸­çš„initWebApplicationContextæ–¹æ³•å¹¶ä¸”å°†è·å–åˆ°çš„servletContextä½œä¸ºå‚æ•°ä¼ å…¥")]),t._v(" "),s("li",[t._v("initWebApplicationContexté¦–å…ˆä¼šå°è¯•ä»servletContextä¸­"),s("strong",[t._v("è·å–æ ¹å®¹å™¨(IOCå®¹å™¨ï¼‰")]),t._v("ï¼Œå¦‚æœå®¹å™¨ä¸ä¸ºç©ºï¼Œåˆ™å®¹å™¨åˆå§‹åŒ–å¤±è´¥,å› ä¸ºweb.xmlä¸­å¯èƒ½å®šä¹‰äº†å¤šä¸ªIoCå®¹å™¨çš„åŠ è½½å™¨ã€‚å‡å¦‚æ­¤æ—¶å®¹å™¨è¿˜æœªåˆå§‹åŒ–ï¼Œåˆ™è°ƒç”¨"),s("strong",[t._v("createWebApplicationContext")]),t._v("æ–¹æ³•åˆ›å»ºä¸€ä¸ªIOCå®¹å™¨(é»˜è®¤æ˜¯"),s("code",[t._v("XMLWebApplicationContext")]),t._v(")ã€‚")]),t._v(" "),s("li",[t._v("åˆ›å»ºå®Œå®¹å™¨ä¹‹åï¼Œå°†ä¼šè°ƒç”¨ä¸€ä¸ªéå¸¸é‡è¦çš„"),s("strong",[t._v("configureAndRefreshWebApplicationContext")]),t._v("æ–¹æ³•ã€‚åœ¨æ‰§è¡Œè¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå°†ä»ApplicationContext.xmlé…ç½®æ–‡ä»¶ä¸­è·å–åˆ°çš„å†…å®¹é…ç½®åˆ°å·²ç»åˆ›å»ºå¥½äº†çš„XmlWebApplicationContextå®¹å™¨ä¸­å»ï¼Œå¹¶è°ƒç”¨"),s("strong",[t._v("refreshæ–¹æ³•æ¥å®ŒæˆIOCå®¹å™¨çš„åˆå§‹åŒ–")]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("ç„¶åï¼Œå†å°†å·²ç»å®Œæˆåˆå§‹åŒ–çš„XmlWebApplicationContextå®¹å™¨æ³¨å†Œåˆ°servletContextä¸­å»ã€‚")])]),t._v(" "),s("blockquote",[s("p",[t._v("å…¶å®åœ¨Webå®¹å™¨ä¸­ï¼ŒServletContextä¸ºSpringçš„IoCå®¹å™¨æä¾›äº†å®¿ä¸»ç¯å¢ƒï¼Œå¯¹åº”çš„å»ºç«‹èµ·ä¸€ä¸ªIoCå®¹å™¨çš„ä½“ç³»ã€‚å…¶ä¸­ï¼Œé¦–å…ˆéœ€è¦å»ºç«‹çš„æ˜¯æ ¹ä¸Šä¸‹æ–‡ï¼Œè¿™ä¸ªä¸Šä¸‹æ–‡æŒæœ‰çš„å¯¹è±¡å¯ä»¥æœ‰ä¸šåŠ¡å¯¹è±¡ã€æ•°æ®å­˜å–å¯¹è±¡ã€èµ„æºã€äº‹åŠ¡ç®¡ç†å™¨ç­‰å„ç§ä¸­é—´å±‚å¯¹è±¡ã€‚")]),t._v(" "),s("p",[t._v("åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡çš„åŸºç¡€ä¸Šï¼Œä¸Web MVCç›¸å…³è¿˜ä¼šæœ‰ä¸€ä¸ªä¸Šä¸‹æ–‡æ¥ä¿æŒæ§åˆ¶å™¨ä¹‹ç±»çš„MVCå¯¹è±¡ï¼Œè¿™æ ·å°±æ„æˆäº†ä¸€ä¸ªå±‚æ¬¡åŒ–çš„ä¸Šä¸‹æ–‡ç»“æ„ã€‚å› ä¸ºåœ¨initWebApplicationContextæ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å®åˆ›å»ºApplicationContextå®¹å™¨çš„å·¥ä½œæ˜¯äº¤ç”±createWebApplicationContextæ–¹æ³•æ¥å®ç°çš„ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæ–¹æ³•")])]),t._v(" "),s("h2",{attrs:{id:"_5-createwebapplicationcontext"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-createwebapplicationcontext"}},[t._v("#")]),t._v(" 5. createWebApplicationContext")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationContext")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletContext")]),t._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™é‡Œåˆ¤æ–­ä½¿ç”¨ä»€ä¹ˆæ ·çš„ç±»åœ¨Webå®¹å™¨ä¸­ä½œä¸ºIOCå®¹å™¨")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" contextClass "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("determineContextClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConfigurableWebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isAssignableFrom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("contextClass"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ApplicationContextException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Custom context class ["')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" contextClass"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"] is not of type ["')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConfigurableWebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"]"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç›´æ¥å®ä¾‹åŒ–éœ€è¦äº§ç”Ÿçš„IOCå®¹å™¨,é»˜è®¤çš„æ˜¯`XMLWebApplicationContext`")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConfigurableWebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BeanUtils")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("instantiateClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("contextClass"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("determineContextClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServletContext")]),t._v(" servletContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" contextClassName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" servletContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInitParameter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CONTEXT_CLASS_PARAM")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„IOC  ")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœæ²¡æœ‰æŒ‡å®šçš„IOCå®¹å™¨ï¼Œåˆ™propertiesä¸­è·å–é»˜è®¤çš„IOCå®¹å™¨ï¼Œä¹Ÿå°±æ˜¯XMLWebApplicationContext")]),t._v("\n\t\t\tcontextClassName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" defaultStrategies"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ClassUtils")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("contextClassName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ContextLoader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getClassLoader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br")])]),s("p",[t._v("æ­¤æ–¹æ³•åŠŸèƒ½")]),t._v(" "),s("ul",[s("li",[t._v("å†³å®šè¦åˆ›å»ºçš„ApplicationContextç±»å‹")]),t._v(" "),s("li",[t._v("å®ä¾‹åŒ–ä¸€ä¸ªApplicationContext")])]),t._v(" "),s("blockquote",[s("p",[t._v("é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•å†³å®šè¦åˆ›å»ºçš„ApplicationContextç±»å‹çš„å‘¢ï¼Ÿ")])]),t._v(" "),s("p",[t._v("èµ·ä½œç”¨çš„æ˜¯determineContextClassæ–¹æ³•")]),t._v(" "),s("h2",{attrs:{id:"_6-mvc-å¤„ç†æµç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-mvc-å¤„ç†æµç¨‹"}},[t._v("#")]),t._v(" 6. mvc å¤„ç†æµç¨‹")]),t._v(" "),s("p",[t._v("å½“æµè§ˆå™¨å‘é€ä¸€ä¸ªè¯·æ±‚ "),s("code",[t._v("http://localhost:8080/hello")]),t._v(" åï¼Œè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ï¼Œå…¶å¤„ç†æµç¨‹æ˜¯ï¼š")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("æœåŠ¡å™¨æä¾›äº† DispatcherServletï¼Œå®ƒä½¿ç”¨çš„æ˜¯æ ‡å‡† Servlet æŠ€æœ¯")]),t._v(" "),s("ul",[s("li",[t._v("è·¯å¾„ï¼šé»˜è®¤æ˜ å°„è·¯å¾„ä¸º "),s("code",[t._v("/")]),t._v("ï¼Œå³ä¼šåŒ¹é…åˆ°æ‰€æœ‰è¯·æ±‚ URLï¼Œå¯ä½œä¸ºè¯·æ±‚çš„ç»Ÿä¸€å…¥å£ï¼Œä¹Ÿè¢«ç§°ä¹‹ä¸º"),s("strong",[t._v("å‰æ§åˆ¶å™¨")]),t._v(" "),s("ul",[s("li",[t._v("jsp ä¸ä¼šåŒ¹é…åˆ° DispatcherServlet")]),t._v(" "),s("li",[t._v("å…¶å®ƒæœ‰è·¯å¾„çš„ Servlet åŒ¹é…ä¼˜å…ˆçº§ä¹Ÿé«˜äº DispatcherServlet")])])]),t._v(" "),s("li",[t._v("åˆ›å»ºï¼šåœ¨ Boot ä¸­ï¼Œç”± DispatcherServletAutoConfiguration è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»æä¾› DispatcherServlet çš„ bean")]),t._v(" "),s("li",[t._v("åˆå§‹åŒ–ï¼šDispatcherServlet åˆå§‹åŒ–æ—¶ä¼šä¼˜å…ˆåˆ°å®¹å™¨é‡Œå¯»æ‰¾å„ç§ç»„ä»¶ï¼Œä½œä¸ºå®ƒçš„æˆå‘˜å˜é‡\n"),s("ul",[s("li",[t._v("HandlerMappingï¼Œåˆå§‹åŒ–æ—¶è®°å½•æ˜ å°„å…³ç³»")]),t._v(" "),s("li",[t._v("HandlerAdapterï¼Œåˆå§‹åŒ–æ—¶å‡†å¤‡å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ã€æ¶ˆæ¯è½¬æ¢å™¨")]),t._v(" "),s("li",[t._v("HandlerExceptionResolverï¼Œåˆå§‹åŒ–æ—¶å‡†å¤‡å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ã€æ¶ˆæ¯è½¬æ¢å™¨")]),t._v(" "),s("li",[t._v("ViewResolver")])])])])]),t._v(" "),s("li",[s("p",[t._v("DispatcherServlet ä¼šåˆ©ç”¨ RequestMappingHandlerMapping æŸ¥æ‰¾æ§åˆ¶å™¨æ–¹æ³•")]),t._v(" "),s("ul",[s("li",[s("p",[t._v('ä¾‹å¦‚æ ¹æ® /hello è·¯å¾„æ‰¾åˆ° @RequestMapping("/hello") å¯¹åº”çš„æ§åˆ¶å™¨æ–¹æ³•')])]),t._v(" "),s("li",[s("p",[t._v("æ§åˆ¶å™¨æ–¹æ³•ä¼šè¢«å°è£…ä¸º HandlerMethod å¯¹è±¡ï¼Œå¹¶ç»“åˆåŒ¹é…åˆ°çš„æ‹¦æˆªå™¨ä¸€èµ·è¿”å›ç»™ DispatcherServlet")])]),t._v(" "),s("li",[s("p",[t._v("HandlerMethod å’Œæ‹¦æˆªå™¨åˆåœ¨ä¸€èµ·ç§°ä¸º HandlerExecutionChainï¼ˆè°ƒç”¨é“¾ï¼‰å¯¹è±¡")])])])]),t._v(" "),s("li",[s("p",[t._v("DispatcherServlet æ¥ä¸‹æ¥ä¼šï¼š")]),t._v(" "),s("ol",[s("li",[t._v("è°ƒç”¨æ‹¦æˆªå™¨çš„ preHandle æ–¹æ³•")]),t._v(" "),s("li",[t._v("RequestMappingHandlerAdapter è°ƒç”¨ handle æ–¹æ³•ï¼Œå‡†å¤‡æ•°æ®ç»‘å®šå·¥å‚ã€æ¨¡å‹å·¥å‚ã€ModelAndViewContainerã€å°† HandlerMethod å®Œå–„ä¸º ServletInvocableHandlerMethod\n"),s("ul",[s("li",[t._v("@ControllerAdvice å…¨å±€å¢å¼ºç‚¹1ï¸âƒ£ï¼šè¡¥å……æ¨¡å‹æ•°æ®")]),t._v(" "),s("li",[t._v("@ControllerAdvice å…¨å±€å¢å¼ºç‚¹2ï¸âƒ£ï¼šè¡¥å……è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨")]),t._v(" "),s("li",[t._v("ä½¿ç”¨ HandlerMethodArgumentResolver å‡†å¤‡å‚æ•°\n"),s("ul",[s("li",[t._v("@ControllerAdvice å…¨å±€å¢å¼ºç‚¹3ï¸âƒ£ï¼šRequestBody å¢å¼º")])])]),t._v(" "),s("li",[t._v("è°ƒç”¨ ServletInvocableHandlerMethod")]),t._v(" "),s("li",[t._v("ä½¿ç”¨ HandlerMethodReturnValueHandler å¤„ç†è¿”å›å€¼\n"),s("ul",[s("li",[t._v("@ControllerAdvice å…¨å±€å¢å¼ºç‚¹4ï¸âƒ£ï¼šResponseBody å¢å¼º")])])]),t._v(" "),s("li",[t._v("æ ¹æ® ModelAndViewContainer è·å– ModelAndView\n"),s("ul",[s("li",[t._v("å¦‚æœè¿”å›çš„ ModelAndView ä¸º nullï¼Œä¸èµ°ç¬¬ 4 æ­¥è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹\n"),s("ul",[s("li",[t._v("ä¾‹å¦‚ï¼Œæœ‰çš„è¿”å›å€¼å¤„ç†å™¨è°ƒç”¨äº† HttpMessageConverter æ¥å°†ç»“æœè½¬æ¢ä¸º JSONï¼Œè¿™æ—¶ ModelAndView å°±ä¸º null")])])]),t._v(" "),s("li",[t._v("å¦‚æœè¿”å›çš„ ModelAndView ä¸ä¸º nullï¼Œä¼šåœ¨ç¬¬ 4 æ­¥èµ°è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹")])])])])]),t._v(" "),s("li",[t._v("è°ƒç”¨æ‹¦æˆªå™¨çš„ postHandle æ–¹æ³•")]),t._v(" "),s("li",[t._v("å¤„ç†å¼‚å¸¸æˆ–è§†å›¾æ¸²æŸ“\n"),s("ul",[s("li",[t._v("å¦‚æœ 1~3 å‡ºç°å¼‚å¸¸ï¼Œèµ° ExceptionHandlerExceptionResolver å¤„ç†å¼‚å¸¸æµç¨‹\n"),s("ul",[s("li",[t._v("@ControllerAdvice å…¨å±€å¢å¼ºç‚¹5ï¸âƒ£ï¼š@ExceptionHandler å¼‚å¸¸å¤„ç†")])])]),t._v(" "),s("li",[t._v("æ­£å¸¸ï¼Œèµ°è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹")])])]),t._v(" "),s("li",[t._v("è°ƒç”¨æ‹¦æˆªå™¨çš„ afterCompletion æ–¹æ³•")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);